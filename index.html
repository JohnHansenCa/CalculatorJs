<!DOCTYPE html>
<!-- TODO: Add eslint for html files, remove ignore statment in eslintrc.js
https://www.npmjs.com/package/eslint-plugin-html -->
<html>
  <head>
    <title>Calculator Js</title>
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTML/Viewport_meta_tag -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="./KeyPadCss/src/styles/keypad.css">
    <link rel="stylesheet" href="./src/styles/calculator.css">

    <!-- FastActive allows a stylus on a touch device to properly invoke the
    CSS :active pseudo-class. -->
    <script src="src/libs/FastActive.min.js" defer=""></script>
    <!-- math.js provides calculator functionality for the application. See Mathjs.org for details. -->
    <!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.5.0/math.js"></script> -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.5.1/math.min.js"></script>
    <script type="module" src="./src/scripts/tscript/calc.js"></script>
    <style>
      body {
        overflow-x: hidden; /* Hide horizontal scrollbar */
        overflow-y: hidden; /* Hide vertical scrollbar */
      }
        .container{
            display:grid;
            max-width: 450px}
    </style>
  </head>
  <body data-kp-select="kp-select">
   <div class="container" >
      
    
   <div id="resultContainer" >
      <div id="calc-status" data-kp="display" style="border:solid; border-width:1px; border-color: fuchsia; height:1.2rem"></div>
     <div id="calc-display" class="calculator-display" data-kp="display" 
      style="border:solid; border-width:1px; border-color: blue">V.01.04 <span style="font-style:italic">Experimental</span></div>
      <div id="key-bucket" class="keybucket-display" data-kp="display" style="border:solid; border-width:1px; border-color: red; "
       contenteditable="true"></div>
    </div>
    
   <div id="keypadcontainer" class="kp-light kp-alpha" style="display:flex; width:100%">
   <div id="keyContainer4by5" class="kp-grid-container" style=" grid-template-columns:  1fr 1fr 1fr 1fr; font-size: 30px;  width:100%">
    
     <button id="kp-key-delete" class="kp-key kp-key-style kp-color kp-red" data-kp="key">‚ê°</button>
     <button id="func-key" class="kp-key kp-key-style kp-color kp-orange" data-kp="popup-key" data-kp-placement="bottom">ùëìx</button>
     <div id="func-popup-container" class="kp-flex-container"  style="display:none" >
       <div class="kp-list-container">
          <!-- style="align-self:unset; height:fit-content" -->
          <button  class="kp-key kp-key-style kp-color" data-kp="show-only-key" data-kp-target="log-btn-container1">trig</button>
          <button  class="kp-key kp-key-style kp-color" data-kp="show-only-key" data-kp-target="math-btn-container1">math</button>
          <button  class="kp-key kp-key-style kp-color" data-kp="show-only-key" data-kp-target="">some stuff</button>
        </div>
       <div class="kp-grid-container" style="grid-template-columns: 1fr">
         <div id="log-btn-container1" class="kp-grid-container" style="grid-template-columns: 1fr 1fr 1fr">
            <button  class="kp-key kp-key-style kp-color" data-kp="key">sin()</button>
             <button  class="kp-key kp-key-style kp-color" data-kp="key">cos()</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">tan()</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">asin()</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">acos()</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">atan()</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">sinh()</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">cosh()</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">tanh()</button> 
         
          </div>
         <div id="math-btn-container1" class="kp-grid-container"  style="grid-template-columns: 1fr 1fr 1fr">
            <button  class="kp-key kp-key-style kp-color" data-kp="key">pi</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">e</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">1/x</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">^</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">x2</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">sqrt()</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">log</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">ln</button>
            <button  class="kp-key kp-key-style kp-color" data-kp="key">!</button>
            
          </div>
        </div>
      </div>
     <button  class="kp-key kp-key-style kp-color kp-yellow" style="font-size:15px" data-kp="popup-key" data-kp-placement="bottom">Units</button>
     <div id="units-popup-container" class ="kp-list-container" style="display:none">
        <button id="massbtn" class="kp-key kp-key-style kp-color kp-list-key" data-kp="popup-key" >mass</button>
       <div id="massdiv" class ="kp-list-container" style="display:none" >
            <button class="kp-key kp-key-style kp-color" data-kp="key">oz</button>
          <button class="kp-key kp-key-style kp-color" data-kp="key">lb</button>
          <button class="kp-key kp-key-style kp-color" data-kp="key">stone</button>
          <button class="kp-key kp-key-style kp-color" data-kp="key">kg</button>
          <button class="kp-key kp-key-style kp-color" data-kp="key">gram</button>
          <button class="kp-key kp-key-style kp-color" data-kp="key">tonne</button>
        </div>
         <button id="lengthbtn"   class="kp-key kp-key-style kp-color kp-green kp-list-key" data-kp="popup-key">length</button>
         <div id="lengthdiv" class ="kp-list-container" style="display:none">
            <button class="kp-key kp-key-style kp-color" data-kp="key">inch</button>
            <button class="kp-key kp-key-style kp-color" data-kp="key">ft</button>
            <button class="kp-key kp-key-style kp-color" data-kp="key">mile</button>
            <button class="kp-key kp-key-style kp-color" data-kp="key">m</button>
            <button class="kp-key kp-key-style kp-color" data-kp="key">km</button>
          </div>
          <button id="timebtn" class="kp-key kp-key-style kp-color kp-list-key" data-kp="popup-key">time</button>
         <div id="timediv" class ="kp-list-container" style="display:none">
            <button class="kp-key kp-key-style kp-color" data-kp="key">second</button>
            <button class="kp-key kp-key-style kp-color" data-kp="key">minute</button>
            <button class="kp-key kp-key-style kp-color" data-kp="key">hour</button>
            <button class="kp-key kp-key-style kp-color" data-kp="key">day</button>
            <button class="kp-key kp-key-style kp-color" data-kp="key">week</button>
            <button class="kp-key kp-key-style kp-color" data-kp="key">year</button>
          </div>
          <button id="tempbtn" class="kp-key kp-key-style kp-color kp-list-key" data-kp="popup-key">temperature</button>
         <div id="tempdiv" class ="kp-list-container" style="display:none">
            <button class="kp-key kp-key-style kp-color" data-kp="key">fahrenheit</button>
            <button class="kp-key kp-key-style kp-color" data-kp="key">celsius</button>
            <button class="kp-key kp-key-style kp-color" data-kp="key">kelvin</button>
          </div>
          <button id="tempbtn" class="kp-key kp-key-style kp-color kp-list-key" data-kp="key"> to </button>
          <button id="tempbtn" class="kp-key kp-key-style kp-color kp-list-key" data-kp="key"> in </button>
    </div>
      <button id="kp-key-backspace" class="kp-key kp-key-style kp-color kp-blue" data-kp="key">‚å´</button>
     
     <button  class="kp-key kp-key-style kp-color" data-kp="key">(</button>
     <button  class="kp-key kp-key-style kp-color" data-kp="key">)</button>
     <button  class="kp-key kp-key-style kp-color" data-kp="key">%</button>
     <button  class="kp-key kp-key-style kp-color" data-kp="key">√∑</button>

     <button  class="kp-key kp-key-style kp-color" data-kp="key">7</button>
     <button  class="kp-key kp-key-style kp-color" data-kp="key">8</button>
     <button  class="kp-key kp-key-style kp-color" data-kp="key">9</button>
     <button  class="kp-key kp-key-style kp-color" data-kp="key">√ó</button>
      
     <button  class="kp-key kp-key-style kp-color" data-kp="key">4</button>
     <button  class="kp-key kp-key-style kp-color" data-kp="key">5</button>
     <button  class="kp-key kp-key-style kp-color" data-kp="key">6</button>
     <button  class="kp-key kp-key-style kp-color" data-kp="key">-</button>
  
     <button  class="kp-key kp-key-style kp-color" data-kp="key">1</button>
     <button  class="kp-key kp-key-style kp-color" data-kp="key">2</button>
     <button  class="kp-key kp-key-style kp-color" data-kp="key">3</button>
     <button  class="kp-key kp-key-style kp-color" data-kp="key">+</button>

     <button  class="kp-key kp-key-style kp-color" data-kp="key">0</button>
     <button  class="kp-key kp-key-style kp-color" data-kp="key">.</button>
     <button id="kp-key-equal" class="kp-key kp-key-style kp-color kp-blue">=</button>
     <button id="kp-key-carriage-return" class="kp-key kp-key-style kp-color kp-green">‚èé</button>
    </div>
</div>
    </div>


    
<script>

  var referenceSize;
  var container2 = document.getElementById("keyContainer4by5");
  function setFontSize(containerElement, multipler){
    let size = (referenceSize*multipler).toString();
    containerElement.style.fontSize = `${size}px`;
  }
  // TODO: Develop a better solution
  // There is probably a better solution
  // https://css-tricks.com/fitting-text-to-a-container/
  function resizeFunc(){
    referenceSize = document.getElementById("keyContainer4by5").clientWidth;
    setFontSize(container2, .1);
    setFontSize(document.getElementById("func-popup-container"), .05);
    setFontSize(document.getElementById("units-popup-container"), .05);
  }
  window.addEventListener("resize", resizeFunc);
  resizeFunc();
  let x = math.evaluate("8+5");
console.log(x);
</script>
<script>
    //TODO: improve PWA caching strategy. build manifest
    // Check that service workers are supported
    if ('serviceWorker' in navigator) {
      // Use the window load event to keep the page load performant
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js');
      });
    }
    </script>
  </body>
</html>
